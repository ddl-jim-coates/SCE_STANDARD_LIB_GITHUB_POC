NEW MACRO
This is an update to the macro 